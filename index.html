<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡πâ‡∏¢‡∏≤ - Naranjo Algorithm</title>

  <!-- ‡πÉ‡∏ä‡πâ‡∏ö‡∏ô GitHub Pages ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (‡πÇ‡∏´‡∏•‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏ú‡πà‡∏≤‡∏ô CDN) -->
  <!-- ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå/Save as PDF ‡∏à‡∏∞‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÉ‡∏ä‡πâ ‚ÄúTH Sarabun New‚Äù (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á) ‡πÅ‡∏•‡∏∞ fallback ‡πÄ‡∏õ‡πá‡∏ô Sarabun ‡∏à‡∏≤‡∏Å Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'SarabunNew', 'TH Sarabun New', 'Sarabun', 'Segoe UI', Tahoma, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
      padding: 30px;
    }

    h1 {
      color: #667eea;
      text-align: center;
      margin-bottom: 10px;
      font-size: 28px;
    }

    .subtitle {
      text-align: center;
      color: #666;
      margin-bottom: 30px;
      font-size: 14px;
    }

    .section {
      margin-bottom: 30px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 10px;
      border-left: 4px solid #667eea;
    }

    .section-title {
      color: #333;
      font-size: 20px;
      margin-bottom: 15px;
      font-weight: 600;
    }

    .form-group { margin-bottom: 15px; }

    label {
      display: block;
      margin-bottom: 5px;
      color: #555;
      font-weight: 500;
    }

    input[type="text"],
    input[type="date"],
    select,
    textarea {
      width: 100%;
      padding: 10px;
      border: 2px solid #ddd;
      border-radius: 5px;
      font-size: 16px;
      transition: border-color 0.3s;
      font-family: inherit;
    }

    textarea { resize: vertical; min-height: 70px; }

    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: #667eea;
    }

    .drug-entry {
      background: white;
      padding: 15px;
      margin-bottom: 10px;
      border-radius: 8px;
      border: 1px solid #ddd;
      position: relative;
    }

    .drug-entry-title {
      font-weight: 600;
      color: #667eea;
      margin-bottom: 10px;
    }

    .add-btn, .remove-btn, .submit-btn, .secondary-btn {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
      transition: all 0.3s;
      font-family: inherit;
    }

    .add-btn {
      background: #28a745;
      color: white;
      margin-top: 10px;
    }
    .add-btn:hover { background: #218838; }

    .secondary-btn {
      background: #6c757d;
      color: white;
    }
    .secondary-btn:hover { background: #5a6268; }

    .remove-btn {
      background: #dc3545;
      color: white;
      position: absolute;
      top: 10px;
      right: 10px;
      padding: 5px 15px;
      font-size: 14px;
    }
    .remove-btn:hover { background: #c82333; }

    .submit-btn {
      background: #667eea;
      color: white;
      width: 100%;
      padding: 15px;
      font-size: 18px;
      margin-top: 20px;
    }
    .submit-btn:hover { background: #5568d3; }

    .question {
      background: white;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 8px;
      border: 1px solid #ddd;
    }

    .question-text {
      font-weight: 500;
      margin-bottom: 10px;
      color: #333;
    }

    .radio-group {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }

    .radio-option {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .radio-option input[type="radio"] { width: auto; cursor: pointer; }
    .radio-option label { margin: 0; cursor: pointer; font-weight: normal; }

    .checkbox-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 12px;
    }

    .symptom-card {
      background: white;
      padding: 12px;
      border-radius: 8px;
      border: 2px solid #ddd;
      cursor: pointer;
      transition: all 0.3s;
      position: relative;
    }

    .symptom-card:hover {
      border-color: #667eea;
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
    }

    .symptom-card.selected {
      border-color: #667eea;
      background: #e7f3ff;
    }

    .symptom-card input[type="checkbox"] {
      position: absolute;
      opacity: 0;
    }

    .symptom-name {
      font-weight: 600;
      color: #333;
      margin-bottom: 5px;
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .symptom-name::before {
      content: "‚òê";
      font-size: 20px;
      color: #999;
    }

    .symptom-card.selected .symptom-name::before {
      content: "‚òë";
      color: #667eea;
    }

    .symptom-description {
      font-size: 13px;
      color: #666;
      line-height: 1.4;
      margin-top: 4px;
    }

    .severity-badge {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
      margin-top: 8px;
      width: fit-content;
    }

    .severity-mild { background: #d4edda; color: #155724; }
    .severity-moderate { background: #fff3cd; color: #856404; }
    .severity-severe { background: #f8d7da; color: #721c24; }
    .severity-emergency { background: #dc3545; color: white; }

    .info-icon {
      display: inline-block;
      width: 16px;
      height: 16px;
      background: #667eea;
      color: white;
      border-radius: 50%;
      text-align: center;
      line-height: 16px;
      font-size: 12px;
      cursor: help;
      margin-left: 5px;
      flex: 0 0 auto;
    }

    .tooltip { position: relative; display: inline-block; }

    .tooltip .tooltiptext {
      visibility: hidden;
      width: 300px;
      background-color: #333;
      color: #fff;
      text-align: left;
      border-radius: 6px;
      padding: 10px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      margin-left: -150px;
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 13px;
      line-height: 1.6;
    }

    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }

    .result {
      display: none;
      background: #e7f3ff;
      padding: 25px;
      border-radius: 10px;
      margin-top: 30px;
      border: 2px solid #667eea;
    }

    .result.show { display: block; }

    .result-title {
      color: #667eea;
      font-size: 24px;
      margin-bottom: 15px;
      text-align: center;
    }

    .result-content { font-size: 18px; color: #333; text-align: center; }

    .score-box {
      background: #667eea;
      color: white;
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
    }

    .patient-info {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
    }

    .alert {
      background: #fff3cd;
      border: 1px solid #ffc107;
      color: #856404;
      padding: 12px;
      border-radius: 5px;
      margin-bottom: 15px;
      line-height: 1.6;
    }

    .legend {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
      padding: 10px;
      background: white;
      border-radius: 5px;
      font-size: 12px;
    }

    .legend-item { display: flex; align-items: center; gap: 5px; }

    .row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 18px;
    }

    .footer-note {
      margin-top: 20px;
      font-size: 13px;
      color: #555;
      line-height: 1.7;
      text-align: center;
    }

    .divider {
      height: 1px;
      background: #e9ecef;
      margin: 10px 0 20px;
    }

    .small-hint { font-size: 12px; color: #666; margin-top: 6px; line-height: 1.5; }

    /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ ‚Äú‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‚Äù ‡πÅ‡∏¢‡∏Å‡πÑ‡∏õ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏õ‡πá‡∏ô PDF ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡πà‡∏ß‡∏ô */
    #reportOnly {
      display: none;
    }

    @media print {
      body { background: white; padding: 0; }
      .container { box-shadow: none; border-radius: 0; max-width: 100%; padding: 0; }
    }

    @media (max-width: 768px) {
      .checkbox-grid { grid-template-columns: 1fr; }
      .patient-info { grid-template-columns: 1fr; }
      .row { grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>üè• ‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡πâ‡∏¢‡∏≤</h1>
    <p class="subtitle">Naranjo Adverse Drug Reaction Probability Scale</p>

    <form id="assessmentForm">
      <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ -->
      <div class="section">
        <h2 class="section-title">üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</h2>
        <div class="patient-info">
          <div class="form-group">
            <label for="hn">HN:</label>
            <input type="text" id="hn" name="hn" required>
          </div>
          <div class="form-group">
            <label for="firstName">‡∏ä‡∏∑‡πà‡∏≠:</label>
            <input type="text" id="firstName" name="firstName" required>
          </div>
          <div class="form-group">
            <label for="lastName">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</label>
            <input type="text" id="lastName" name="lastName" required>
          </div>
          <div class="form-group">
            <label for="phone">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</label>
            <input type="text" id="phone" name="phone" required>
          </div>
        </div>
      </div>

      <!-- ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ú‡∏∑‡πà‡∏ô‡πÅ‡∏û‡πâ‡∏¢‡∏≤ -->
      <div class="section">
        <h2 class="section-title">üíä ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ú‡∏∑‡πà‡∏ô‡πÅ‡∏û‡πâ‡∏¢‡∏≤</h2>
        <div class="alert">
          ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ú‡∏∑‡πà‡∏ô‡πÅ‡∏û‡πâ‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 1 ‡∏Ç‡πâ‡∏≠) ‚Äî ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å/‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å ‡πÅ‡∏•‡∏∞‡∏ß‡∏≤‡∏á‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏ó‡∏µ‡πà (i) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
        </div>

        <div class="checkbox-grid" id="symptomsGrid">
          <!-- Maculopapular rash -->
          <div class="symptom-card" onclick="toggleSymptom(this, 'symp1')">
            <input type="checkbox" id="symp1" name="symptoms" value="Maculopapular rash (MP rash)">
            <div class="symptom-name">
              Maculopapular rash (MP rash)
              <span class="tooltip">
                <span class="info-icon">i</span>
                <span class="tooltiptext">
                  <strong>‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞:</strong> ‡∏ú‡∏∑‡πà‡∏ô‡∏£‡∏≤‡∏ö‡πÅ‡∏•‡∏∞‡∏ï‡∏∏‡πà‡∏°‡∏ô‡∏π‡∏ô‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏ú‡∏™‡∏°‡∏Å‡∏±‡∏ô<br>
                  <strong>‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢:</strong> ‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏™‡∏°‡∏°‡∏≤‡∏ï‡∏£ 2 ‡∏Ç‡πâ‡∏≤‡∏á<br>
                  <strong>‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏£‡πà‡∏ß‡∏°:</strong> ‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡πÑ‡∏Ç‡πâ ‡∏Ñ‡∏±‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢
                </span>
              </span>
            </div>
            <div class="symptom-description">‡∏ú‡∏∑‡πà‡∏ô‡∏£‡∏≤‡∏ö‡πÅ‡∏•‡∏∞‡∏ï‡∏∏‡πà‡∏°‡∏ô‡∏π‡∏ô‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏ú‡∏™‡∏°‡∏Å‡∏±‡∏ô ‚Äî ‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</div>
            <span class="severity-badge severity-mild">‡∏ö‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span>
          </div>

          <!-- Urticaria -->
          <div class="symptom-card" onclick="toggleSymptom(this, 'symp2')">
            <input type="checkbox" id="symp2" name="symptoms" value="Urticaria (‡∏•‡∏°‡∏û‡∏¥‡∏©)">
            <div class="symptom-name">
              Urticaria (‡∏•‡∏°‡∏û‡∏¥‡∏©)
              <span class="tooltip">
                <span class="info-icon">i</span>
                <span class="tooltiptext">
                  <strong>‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞:</strong> ‡∏ú‡∏∑‡πà‡∏ô‡∏ô‡∏π‡∏ô‡πÅ‡∏î‡∏á ‡∏Ç‡∏≠‡∏ö‡∏ä‡∏±‡∏î<br>
                  <strong>‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:</strong> ‡∏¢‡∏∏‡∏ö‡∏´‡∏≤‡∏¢‡πÄ‡∏≠‡∏á‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 24 ‡∏ä‡∏°.<br>
                  <strong>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á:</strong> ‡∏≠‡∏≤‡∏à‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏õ‡πá‡∏ô anaphylaxis
                </span>
              </span>
            </div>
            <div class="symptom-description">‡∏ú‡∏∑‡πà‡∏ô‡∏ô‡∏π‡∏ô‡πÅ‡∏î‡∏á ‡∏Ç‡∏≠‡∏ö‡∏ä‡∏±‡∏î ‡∏Ñ‡∏±‡∏ô‡∏°‡∏≤‡∏Å ‡∏¢‡∏∏‡∏ö‡∏´‡∏≤‡∏¢‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 24 ‡∏ä‡∏°.</div>
            <span class="severity-badge severity-moderate">‡∏£‡∏∞‡∏ß‡∏±‡∏á</span>
          </div>

          <!-- Angioedema -->
          <div class="symptom-card" onclick="toggleSymptom(this, 'symp3')">
            <input type="checkbox" id="symp3" name="symptoms" value="Angioedema">
            <div class="symptom-name">
              Angioedema
              <span class="tooltip">
                <span class="info-icon">i</span>
                <span class="tooltiptext">
                  <strong>‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞:</strong> ‡∏ö‡∏ß‡∏°‡∏•‡∏∂‡∏Å‡πÉ‡∏ï‡πâ‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á<br>
                  <strong>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:</strong> ‡∏£‡∏¥‡∏°‡∏ù‡∏µ‡∏õ‡∏≤‡∏Å ‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≤ ‡∏•‡∏¥‡πâ‡∏ô ‡πÉ‡∏ö‡∏´‡∏ô‡πâ‡∏≤<br>
                  <strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:</strong> ‡∏≠‡∏≤‡∏à‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö anaphylactic shock
                </span>
              </span>
            </div>
            <div class="symptom-description">‡∏ö‡∏ß‡∏°‡∏•‡∏∂‡∏Å‡πÉ‡∏ï‡πâ‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á ‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏õ‡∏≤‡∏Å ‡∏ï‡∏≤ ‡∏•‡∏¥‡πâ‡∏ô</div>
            <span class="severity-badge severity-emergency">‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô</span>
          </div>

          <!-- Fixed Drug Eruption -->
          <div class="symptom-card" onclick="toggleSymptom(this, 'symp4')">
            <input type="checkbox" id="symp4" name="symptoms" value="Fixed Drug Eruption">
            <div class="symptom-name">
              Fixed Drug Eruption
              <span class="tooltip">
                <span class="info-icon">i</span>
                <span class="tooltiptext">
                  <strong>‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞:</strong> ‡∏ú‡∏∑‡πà‡∏ô‡∏Å‡∏•‡∏°/‡∏£‡∏µ ‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏Ñ‡∏•‡πâ‡∏≥/‡∏°‡πà‡∏ß‡∏á<br>
                  <strong>‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡πÄ‡∏â‡∏û‡∏≤‡∏∞:</strong> ‡πÄ‡∏Å‡∏¥‡∏î‡∏ã‡πâ‡∏≥‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏î‡∏¥‡∏°<br>
                  <strong>‡∏´‡∏•‡∏±‡∏á‡∏´‡∏≤‡∏¢:</strong> ‡∏°‡∏±‡∏Å‡∏ó‡∏¥‡πâ‡∏á‡∏£‡∏≠‡∏¢‡∏î‡∏≥
                </span>
              </span>
            </div>
            <div class="symptom-description">‡∏ú‡∏∑‡πà‡∏ô‡∏Å‡∏•‡∏°/‡∏£‡∏µ ‡∏™‡∏µ‡∏Ñ‡∏•‡πâ‡∏≥ ‡πÄ‡∏Å‡∏¥‡∏î‡∏ã‡πâ‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏¥‡∏° ‡∏ó‡∏¥‡πâ‡∏á‡∏£‡∏≠‡∏¢‡∏î‡∏≥</div>
            <span class="severity-badge severity-mild">‡∏ó‡∏¥‡πâ‡∏á‡∏£‡∏≠‡∏¢</span>
          </div>

          <!-- Exfoliative dermatitis -->
          <div class="symptom-card" onclick="toggleSymptom(this, 'symp5')">
            <input type="checkbox" id="symp5" name="symptoms" value="Exfoliative dermatitis">
            <div class="symptom-name">
              Exfoliative dermatitis
              <span class="tooltip">
                <span class="info-icon">i</span>
                <span class="tooltiptext">
                  <strong>‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞:</strong> ‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡πÅ‡∏î‡∏á‡∏•‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏∏‡∏¢‡∏ó‡∏±‡πà‡∏ß‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢<br>
                  <strong>‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏£‡πà‡∏ß‡∏°:</strong> ‡∏Ñ‡∏±‡∏ô ‡πÅ‡∏´‡πâ‡∏á ‡∏´‡∏ô‡∏≤‡∏ß‡∏™‡∏±‡πà‡∏ô<br>
                  <strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á:</strong> ‡πÄ‡∏ù‡πâ‡∏≤‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏†‡∏≤‡∏ß‡∏∞‡πÅ‡∏ó‡∏£‡∏Å‡∏ã‡πâ‡∏≠‡∏ô
                </span>
              </span>
            </div>
            <div class="symptom-description">‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡πÅ‡∏î‡∏á‡∏•‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏∏‡∏¢‡∏ó‡∏±‡πà‡∏ß‡∏ï‡∏±‡∏ß ‡∏™‡∏π‡∏ç‡πÄ‡∏™‡∏µ‡∏¢‡∏ô‡πâ‡∏≥‡πÅ‡∏•‡∏∞‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô</div>
            <span class="severity-badge severity-severe">‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á</span>
          </div>

          <!-- Erythema multiforme -->
          <div class="symptom-card" onclick="toggleSymptom(this, 'symp6')">
            <input type="checkbox" id="symp6" name="symptoms" value="Erythema multiforme (EM)">
            <div class="symptom-name">
              Erythema multiforme (EM)
              <span class="tooltip">
                <span class="info-icon">i</span>
                <span class="tooltiptext">
                  <strong>‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞:</strong> ‡∏ú‡∏∑‡πà‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏ò‡∏ô‡∏π (target lesion)<br>
                  <strong>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:</strong> ‡πÅ‡∏Ç‡∏ô ‡∏Ç‡∏≤ ‡∏ù‡πà‡∏≤‡∏°‡∏∑‡∏≠ ‡∏ù‡πà‡∏≤‡πÄ‡∏ó‡πâ‡∏≤<br>
                  <strong>‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏£‡πà‡∏ß‡∏°:</strong> ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠ (HSV) ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏≤
                </span>
              </span>
            </div>
            <div class="symptom-description">‡∏ú‡∏∑‡πà‡∏ô‡∏£‡∏π‡∏õ‡πÄ‡∏õ‡πâ‡∏≤‡∏ò‡∏ô‡∏π ‡∏ó‡∏µ‡πà‡πÅ‡∏Ç‡∏ô ‡∏Ç‡∏≤ ‡∏ù‡πà‡∏≤‡∏°‡∏∑‡∏≠ ‡∏ù‡πà‡∏≤‡πÄ‡∏ó‡πâ‡∏≤</div>
            <span class="severity-badge severity-moderate">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</span>
          </div>

          <!-- SJS -->
          <div class="symptom-card" onclick="toggleSymptom(this, 'symp7')">
            <input type="checkbox" id="symp7" name="symptoms" value="Stevens-Johnson Syndrome (SJS)">
            <div class="symptom-name">
              Stevens-Johnson Syndrome (SJS)
              <span class="tooltip">
                <span class="info-icon">i</span>
                <span class="tooltiptext">
                  <strong>‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞:</strong> ‡∏ú‡∏∑‡πà‡∏ô‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á ‡∏•‡∏≠‡∏Å‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏¢‡∏∑‡πà‡∏≠‡∏ö‡∏∏<br>
                  <strong>‡∏≠‡∏ß‡∏±‡∏¢‡∏ß‡∏∞:</strong> ‡∏ï‡∏≤ ‡∏õ‡∏≤‡∏Å ‡∏≠‡∏ß‡∏±‡∏¢‡∏ß‡∏∞‡πÄ‡∏û‡∏®<br>
                  <strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á:</strong> ‡∏†‡∏≤‡∏ß‡∏∞‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå
                </span>
              </span>
            </div>
            <div class="symptom-description">‡∏ú‡∏∑‡πà‡∏ô‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á ‡∏•‡∏≠‡∏Å‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏¢‡∏∑‡πà‡∏≠‡∏ö‡∏∏ ‚Äî ‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô!</div>
            <span class="severity-badge severity-emergency">‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô!</span>
          </div>

          <!-- TEN -->
          <div class="symptom-card" onclick="toggleSymptom(this, 'symp8')">
            <input type="checkbox" id="symp8" name="symptoms" value="Toxic Epidermal Necrolysis (TEN)">
            <div class="symptom-name">
              Toxic Epidermal Necrolysis (TEN)
              <span class="tooltip">
                <span class="info-icon">i</span>
                <span class="tooltiptext">
                  <strong>‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞:</strong> ‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏•‡∏≠‡∏Å &gt;30% ‡∏Ç‡∏≠‡∏á‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢<br>
                  <strong>‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:</strong> Nikolsky's sign ‡∏ö‡∏ß‡∏Å<br>
                  <strong>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏ï‡∏≤‡∏¢:</strong> ‡∏™‡∏π‡∏á ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÉ‡∏ô ICU/Burn unit
                </span>
              </span>
            </div>
            <div class="symptom-description">‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏•‡∏≠‡∏Å &gt;30% ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏ï‡∏≤‡∏¢‡∏™‡∏π‡∏á ICU/Burn unit</div>
            <span class="severity-badge severity-emergency">‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢!</span>
          </div>
        </div>

        <div class="legend">
          <div class="legend-item"><span class="severity-badge severity-mild">‡∏ö‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î/‡∏ó‡∏¥‡πâ‡∏á‡∏£‡∏≠‡∏¢</span></div>
          <div class="legend-item"><span class="severity-badge severity-moderate">‡∏£‡∏∞‡∏ß‡∏±‡∏á/‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</span></div>
          <div class="legend-item"><span class="severity-badge severity-severe">‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á</span></div>
          <div class="legend-item"><span class="severity-badge severity-emergency">‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô/‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢</span></div>
        </div>

        <div class="divider"></div>

        <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏á -->
        <h3 style="color:#333; font-size:16px; margin-bottom:10px; font-weight:600;">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡πâ‡∏¢‡∏≤‡∏≠‡∏∑‡πà‡∏ô ‡πÜ (‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á)</h3>
        <div class="row">
          <div class="form-group">
            <label for="customSymptomName">‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏Å‡∏≤‡∏£/‡∏ú‡∏∑‡πà‡∏ô:</label>
            <input type="text" id="customSymptomName" placeholder="‡πÄ‡∏ä‡πà‡∏ô Morbilliform rash / ‡∏ú‡∏∑‡πà‡∏ô‡∏ä‡∏ô‡∏¥‡∏î‡∏≠‡∏∑‡πà‡∏ô">
          </div>
          <div class="form-group">
            <label for="customSymptomSeverity">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á (‡∏õ‡πâ‡∏≤‡∏¢‡∏Å‡∏≥‡∏Å‡∏±‡∏ö):</label>
            <select id="customSymptomSeverity">
              <option value="mild">‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢/‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (Mild)</option>
              <option value="moderate">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á/‡πÄ‡∏ù‡πâ‡∏≤‡∏£‡∏∞‡∏ß‡∏±‡∏á (Moderate)</option>
              <option value="severe">‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á (Severe)</option>
              <option value="emergency">‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô (Emergency)</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label for="customSymptomDesc">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°:</label>
          <textarea id="customSymptomDesc" placeholder="‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡πÄ‡∏î‡πà‡∏ô ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏£‡πà‡∏ß‡∏° ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á ‡∏Ø‡∏•‡∏Ø"></textarea>
          <div class="small-hint">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 1 ‡∏Ç‡πâ‡∏≠)</div>
        </div>
        <button type="button" class="add-btn" onclick="addCustomSymptom()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ</button>
      </div>

      <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏á‡∏™‡∏±‡∏¢ -->
      <div class="section">
        <h2 class="section-title">üíä ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏á‡∏™‡∏±‡∏¢</h2>
        <div id="drugsContainer">
          <div class="drug-entry">
            <div class="drug-entry-title">‡∏¢‡∏≤‡∏ó‡∏µ‡πà 1</div>
            <div class="form-group">
              <label>‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤:</label>
              <input type="text" name="drugName[]" required>
            </div>
            <div class="form-group">
              <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏¢‡∏≤:</label>
              <input type="date" name="drugDate[]" required>
            </div>
          </div>
        </div>
        <button type="button" class="add-btn" onclick="addDrugEntry()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤</button>
      </div>

      <!-- ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á -->
      <div class="section">
        <h2 class="section-title">‚ö†Ô∏è ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á‡∏Ç‡∏≠‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏£</h2>
        <div class="form-group">
          <select id="severity" name="severity" required>
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á --</option>
            <option value="‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢">‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ (Mild)</option>
            <option value="‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á (Moderate)</option>
            <option value="‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á">‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á (Severe)</option>
            <option value="‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏°‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï">‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏°‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï (Life-threatening)</option>
          </select>
        </div>
      </div>

      <!-- Naranjo Algorithm -->
      <div class="section">
        <h2 class="section-title">üìù ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô Naranjo Algorithm</h2>
        <div class="alert">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á 10 ‡∏Ç‡πâ‡∏≠ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡πâ‡∏¢‡∏≤</div>

        <div class="question">
          <div class="question-text">1. ‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡πâ‡∏¢‡∏≤‡∏ä‡∏ô‡∏¥‡∏î‡∏ô‡∏µ‡πâ‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</div>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" id="q1_yes" name="q1" value="‡πÉ‡∏ä‡πà" required>
              <label for="q1_yes">‡πÉ‡∏ä‡πà (+1)</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="q1_no" name="q1" value="‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà">
              <label for="q1_no">‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà (0)</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="q1_unknown" name="q1" value="‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö">
              <label for="q1_unknown">‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö (0)</label>
            </div>
          </div>
        </div>

        <div class="question">
          <div class="question-text">2. ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏á‡∏™‡∏±‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</div>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" id="q2_yes" name="q2" value="‡πÉ‡∏ä‡πà" required>
              <label for="q2_yes">‡πÉ‡∏ä‡πà (+2)</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="q2_no" name="q2" value="‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà">
              <label for="q2_no">‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà (-1)</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="q2_unknown" name="q2" value="‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö">
              <label for="q2_unknown">‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö (0)</label>
            </div>
          </div>
        </div>

        <div class="question">
          <div class="question-text">3. ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏¢‡∏∏‡∏î‡∏¢‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏´‡πâ‡∏¢‡∏≤‡∏ï‡πâ‡∏≤‡∏ô‡∏û‡∏¥‡∏©‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</div>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" id="q3_yes" name="q3" value="‡πÉ‡∏ä‡πà" required>
              <label for="q3_yes">‡πÉ‡∏ä‡πà (+1)</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="q3_no" name="q3" value="‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà">
              <label for="q3_no">‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà (0)</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="q3_unknown" name="q3" value="‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö">
              <label for="q3_unknown">‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö (0)</label>
            </div>
          </div>
        </div>

        <div class="question">
          <div class="question-text">4. ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏≠‡∏µ‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏¢‡∏≤‡∏ã‡πâ‡∏≥‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</div>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" id="q4_yes" name="q4" value="‡πÉ‡∏ä‡πà" required>
              <label for="q4_yes">‡πÉ‡∏ä‡πà (+2)</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="q4_no" name="q4" value="‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà">
              <label for="q4_no">‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà (-1)</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="q4_unknown" name="q4" value="‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö">
              <label for="q4_unknown">‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö (0)</label>
            </div>
          </div>
        </div>

        <div class="question">
          <div class="question-text">5. ‡∏°‡∏µ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏≠‡∏∑‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</div>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" id="q5_yes" name="q5" value="‡πÉ‡∏ä‡πà" required>
              <label for="q5_yes">‡πÉ‡∏ä‡πà (-1)</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="q5_no" name="q5" value="‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà">
              <label for="q5_no">‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà (+2)</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="q5_unknown" name="q5" value="‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö">
              <label for="q5_unknown">‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö (0)</label>
            </div>
          </div>
        </div>

        <div class="question">
          <div class="question-text">6. ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏¢‡∏≤‡∏´‡∏•‡∏≠‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</div>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" id="q6_yes" name="q6" value="‡πÉ‡∏ä‡πà" required>
              <label for="q6_yes">‡πÉ‡∏ä‡πà (-1)</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="q6_no" name="q6" value="‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà">
              <label for="q6_no">‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà (+1)</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="q6_unknown" name="q6" value="‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö">
              <label for="q6_unknown">‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö (0)</label>
            </div>
          </div>
        </div>

        <div class="question">
          <div class="question-text">7. ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏¢‡∏≤‡πÉ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ß‡πÉ‡∏ô‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏¥‡∏©‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</div>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" id="q7_yes" name="q7" value="‡πÉ‡∏ä‡πà" required>
              <label for="q7_yes">‡πÉ‡∏ä‡πà (+1)</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="q7_no" name="q7" value="‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà">
              <label for="q7_no">‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà (0)</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="q7_unknown" name="q7" value="‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö">
              <label for="q7_unknown">‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö (0)</label>
            </div>
          </div>
        </div>

        <div class="question">
          <div class="question-text">8. ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ö‡∏≤‡∏•‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</div>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" id="q8_yes" name="q8" value="‡πÉ‡∏ä‡πà" required>
              <label for="q8_yes">‡πÉ‡∏ä‡πà (+1)</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="q8_no" name="q8" value="‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà">
              <label for="q8_no">‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà (0)</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="q8_unknown" name="q8" value="‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö">
              <label for="q8_unknown">‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö (0)</label>
            </div>
          </div>
        </div>

        <div class="question">
          <div class="question-text">9. ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÄ‡∏Ñ‡∏¢‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Ñ‡∏•‡∏∂‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏±‡∏ö‡∏¢‡∏≤‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</div>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" id="q9_yes" name="q9" value="‡πÉ‡∏ä‡πà" required>
              <label for="q9_yes">‡πÉ‡∏ä‡πà (+1)</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="q9_no" name="q9" value="‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà">
              <label for="q9_no">‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà (0)</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="q9_unknown" name="q9" value="‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö">
              <label for="q9_unknown">‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö (0)</label>
            </div>
          </div>
        </div>

        <div class="question">
          <div class="question-text">10. ‡∏°‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡πâ‡∏¢‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</div>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" id="q10_yes" name="q10" value="‡πÉ‡∏ä‡πà" required>
              <label for="q10_yes">‡πÉ‡∏ä‡πà (+1)</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="q10_no" name="q10" value="‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà">
              <label for="q10_no">‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà (0)</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="q10_unknown" name="q10" value="‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö">
              <label for="q10_unknown">‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö (0)</label>
            </div>
          </div>
        </div>
      </div>

      <!-- ‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô -->
      <div class="section">
        <h2 class="section-title">üë®‚Äç‚öïÔ∏è ‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô (‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£)</h2>
        <div class="row">
          <div class="form-group">
            <label for="pharmacistName">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô:</label>
            <input type="text" id="pharmacistName" name="pharmacistName" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏†‡∏Å. ... ..." required>
          </div>
          <div class="form-group">
            <label for="pharmacistLicense">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ):</label>
            <input type="text" id="pharmacistLicense" name="pharmacistLicense" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏†.12345">
          </div>
        </div>
        <div class="form-group">
          <label for="assessmentPlace">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô/‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ):</label>
          <input type="text" id="assessmentPlace" name="assessmentPlace" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å/‡∏£‡πâ‡∏≤‡∏ô‡∏¢‡∏≤/‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•...">
        </div>
      </div>

      <button type="submit" class="submit-btn">üìä ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•</button>

      <div class="footer-note">
        ‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ô‡∏µ‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤ ‡πÇ‡∏î‡∏¢ ‡∏†‡∏Å.‡∏ö‡∏£‡∏£‡∏ì‡∏™‡∏£‡∏ì‡πå ‡πÄ‡∏ï‡∏ä‡∏∞‡∏à‡∏≥‡πÄ‡∏£‡∏¥‡∏ç‡∏™‡∏∏‡∏Ç ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏´‡∏≤‡∏Å‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà bunnasornt@gmail.com
      </div>
    </form>

    <!-- ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô (‡πÅ‡∏™‡∏î‡∏á‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö) -->
    <div id="result" class="result">
      <h2 class="result-title">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</h2>
      <div id="resultContent" class="result-content"></div>

      <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô -->
      <div class="actions">
        <button type="button" class="submit-btn" style="width:auto; padding:10px 22px;" onclick="printResultAsPDF()">
          üßæ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô PDF (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô)
        </button>
        <button type="button" class="secondary-btn" onclick="resetAll()">
          üîÑ Reset
        </button>
      </div>

      <div class="small-hint" style="text-align:center; margin-top:10px;">
        ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏õ‡∏∏‡πà‡∏° ‚Äú‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô PDF‚Äù ‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå/‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô PDF (Save as PDF)
      </div>
    </div>
  </div>

  <!-- ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏¥‡∏°‡∏û‡πå/Export PDF ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô -->
  <div id="reportOnly"></div>

  <script>
    let drugCount = 1;
    let customSymptomCounter = 1000; // ‡∏Å‡∏±‡∏ô‡∏ä‡∏ô id ‡πÑ‡∏°‡πà‡∏ä‡∏ô‡∏Å‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°

    function toggleSymptom(card, checkboxId) {
      const checkbox = document.getElementById(checkboxId);
      checkbox.checked = !checkbox.checked;
      card.classList.toggle('selected');
    }

    function addDrugEntry() {
      drugCount++;
      const container = document.getElementById('drugsContainer');
      const newEntry = document.createElement('div');
      newEntry.className = 'drug-entry';
      newEntry.innerHTML = `
        <button type="button" class="remove-btn" onclick="removeDrugEntry(this)">‚úñ ‡∏•‡∏ö</button>
        <div class="drug-entry-title">‡∏¢‡∏≤‡∏ó‡∏µ‡πà ${drugCount}</div>
        <div class="form-group">
          <label>‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤:</label>
          <input type="text" name="drugName[]" required>
        </div>
        <div class="form-group">
          <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏¢‡∏≤:</label>
          <input type="date" name="drugDate[]" required>
        </div>
      `;
      container.appendChild(newEntry);
    }

    function removeDrugEntry(button) {
      if (document.querySelectorAll('.drug-entry').length > 1) {
        button.parentElement.remove();
        updateDrugNumbers();
      } else {
        alert('‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
      }
    }

    function updateDrugNumbers() {
      const entries = document.querySelectorAll('.drug-entry');
      entries.forEach((entry, index) => {
        entry.querySelector('.drug-entry-title').textContent = `‡∏¢‡∏≤‡∏ó‡∏µ‡πà ${index + 1}`;
      });
      drugCount = entries.length;
    }

    function severityMeta(sevKey) {
      // ‡πÉ‡∏ä‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏á
      const map = {
        mild:      { badgeClass: 'severity-mild',      label: '‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ',   urgent: false },
        moderate:  { badgeClass: 'severity-moderate',  label: '‡πÄ‡∏ù‡πâ‡∏≤‡∏£‡∏∞‡∏ß‡∏±‡∏á', urgent: false },
        severe:    { badgeClass: 'severity-severe',    label: '‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á',   urgent: false },
        emergency: { badgeClass: 'severity-emergency', label: '‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô',  urgent: true  }
      };
      return map[sevKey] || map.mild;
    }

    function addCustomSymptom() {
      const name = (document.getElementById('customSymptomName').value || '').trim();
      const desc = (document.getElementById('customSymptomDesc').value || '').trim();
      const sevKey = document.getElementById('customSymptomSeverity').value;

      if (!name) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏ ‚Äú‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏Å‡∏≤‡∏£/‡∏ú‡∏∑‡πà‡∏ô‚Äù ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°');
        return;
      }

      customSymptomCounter++;
      const id = `custom_symp_${customSymptomCounter}`;
      const meta = severityMeta(sevKey);

      const grid = document.getElementById('symptomsGrid');
      const card = document.createElement('div');
      card.className = 'symptom-card';
      card.setAttribute('onclick', `toggleSymptom(this, '${id}')`);

      // tooltip ‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏á‡πà‡∏≤‡∏¢ (‡πÉ‡∏ä‡πâ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏õ‡πá‡∏ô tooltip)
      const tooltipHtml = desc
        ? `<span class="tooltip">
             <span class="info-icon">i</span>
             <span class="tooltiptext">
               <strong>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î:</strong> ${escapeHtml(desc).replace(/\n/g, '<br>')}
             </span>
           </span>`
        : '';

      card.innerHTML = `
        <input type="checkbox" id="${id}" name="symptoms" value="${escapeHtml(name)}">
        <div class="symptom-name">
          ${escapeHtml(name)}
          ${tooltipHtml}
        </div>
        <div class="symptom-description">
          ${desc ? escapeHtml(desc) : '‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°)'}
        </div>
        <span class="severity-badge ${meta.badgeClass}">${meta.label}</span>
      `;

      grid.appendChild(card);

      // ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å
      document.getElementById('customSymptomName').value = '';
      document.getElementById('customSymptomDesc').value = '';
      document.getElementById('customSymptomSeverity').value = 'mild';
      window.scrollTo({ top: card.getBoundingClientRect().top + window.scrollY - 100, behavior: 'smooth' });
    }

    function escapeHtml(str) {
      return String(str)
        .replaceAll('&', '&amp;')
        .replaceAll('<', '&lt;')
        .replaceAll('>', '&gt;')
        .replaceAll('"', '&quot;')
        .replaceAll("'", '&#039;');
    }

    // Naranjo Algorithm Scoring
    const SCORING = {
      1:  { '‡πÉ‡∏ä‡πà': 1,  '‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà': 0,  '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö': 0 },
      2:  { '‡πÉ‡∏ä‡πà': 2,  '‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà': -1, '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö': 0 },
      3:  { '‡πÉ‡∏ä‡πà': 1,  '‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà': 0,  '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö': 0 },
      4:  { '‡πÉ‡∏ä‡πà': 2,  '‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà': -1, '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö': 0 },
      5:  { '‡πÉ‡∏ä‡πà': -1, '‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà': 2,  '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö': 0 },
      6:  { '‡πÉ‡∏ä‡πà': -1, '‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà': 1,  '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö': 0 },
      7:  { '‡πÉ‡∏ä‡πà': 1,  '‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà': 0,  '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö': 0 },
      8:  { '‡πÉ‡∏ä‡πà': 1,  '‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà': 0,  '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö': 0 },
      9:  { '‡πÉ‡∏ä‡πà': 1,  '‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà': 0,  '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö': 0 },
      10: { '‡πÉ‡∏ä‡πà': 1,  '‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà': 0,  '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö': 0 }
    };

    function interpretNaranjo(score) {
      if (score >= 9) return { text: "‡πÉ‡∏ä‡πà‡πÅ‡∏ô‡πà (Definite)", color: "#dc3545" };
      if (score >= 5) return { text: "‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πà (Probable)", color: "#fd7e14" };
      if (score >= 1) return { text: "‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÉ‡∏ä‡πà (Possible)", color: "#ffc107", textColor: "#212529" };
      return { text: "‡πÑ‡∏°‡πà‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πà (Doubtful)", color: "#28a745" };
    }

    function isEmergencySymptom(symptomText) {
      // ‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô (‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ)
      const s = (symptomText || '').toLowerCase();
      return (
        s.includes('stevens-johnson') ||
        s.includes('sjs') ||
        s.includes('toxic epidermal necrolysis') ||
        s.includes('ten') ||
        s.includes('angioedema') ||
        s.includes('anaphyl') ||
        s.includes('shock')
      );
    }

    document.getElementById('assessmentForm').addEventListener('submit', function(e) {
      e.preventDefault();

      // Patient info
      const hn = document.getElementById('hn').value.trim();
      const firstName = document.getElementById('firstName').value.trim();
      const lastName = document.getElementById('lastName').value.trim();
      const phone = document.getElementById('phone').value.trim();

      // Pharmacist info
      const pharmacistName = document.getElementById('pharmacistName').value.trim();
      const pharmacistLicense = document.getElementById('pharmacistLicense').value.trim();
      const assessmentPlace = document.getElementById('assessmentPlace').value.trim();

      // Symptoms
      const selectedSymptoms = Array.from(document.querySelectorAll('input[name="symptoms"]:checked'))
        .map(cb => cb.value);
      const symptomsText = selectedSymptoms.length > 0 ? selectedSymptoms.join(', ') : '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';

      // Drugs
      const drugNames = Array.from(document.querySelectorAll('input[name="drugName[]"]')).map(i => i.value.trim());
      const drugDates = Array.from(document.querySelectorAll('input[name="drugDate[]"]')).map(i => i.value);
      const drugsList = drugNames.map((name, i) => `${name || '(‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤)'} (${drugDates[i] || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà'})`).join(', ');

      // Severity
      const severity = document.getElementById('severity').value;

      // Naranjo score
      let score = 0;
      for (let i = 1; i <= 10; i++) {
        const picked = document.querySelector(`input[name="q${i}"]:checked`);
        const answer = picked ? picked.value : null;
        score += (answer && SCORING[i][answer] != null) ? SCORING[i][answer] : 0;
      }

      const interp = interpretNaranjo(score);
      const emergencyFlag = selectedSymptoms.some(isEmergencySymptom);

      // timestamp
      const now = new Date();
      const assessedAt = now.toLocaleString('th-TH', { year:'numeric', month:'2-digit', day:'2-digit', hour:'2-digit', minute:'2-digit' });

      // Web result content
      const resultContent = document.getElementById('resultContent');
      resultContent.innerHTML = `
        <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 15px; text-align:left;">
          <h3 style="color: #667eea; margin-bottom: 12px;">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</h3>
          <p><strong>HN:</strong> ${escapeHtml(hn)}</p>
          <p><strong>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</strong> ${escapeHtml(firstName)} ${escapeHtml(lastName)}</p>
          <p><strong>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£:</strong> ${escapeHtml(phone)}</p>
          <p><strong>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ú‡∏∑‡πà‡∏ô‡πÅ‡∏û‡πâ‡∏¢‡∏≤:</strong> ${escapeHtml(symptomsText)}</p>
          <p><strong>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á:</strong> ${escapeHtml(severity)}</p>
          <p><strong>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏á‡∏™‡∏±‡∏¢:</strong> ${escapeHtml(drugsList)}</p>
          <p><strong>‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô:</strong> ${escapeHtml(assessedAt)}</p>

          <div style="margin-top:12px;">
            <h3 style="color: #667eea; margin-bottom: 10px;">‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</h3>
            <p><strong>‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô:</strong> ${escapeHtml(pharmacistName)}</p>
            <p><strong>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û:</strong> ${escapeHtml(pharmacistLicense || '-')}</p>
            <p><strong>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô/‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà:</strong> ${escapeHtml(assessmentPlace || '-')}</p>
          </div>
        </div>

        <div class="score-box">
          ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô Naranjo: ${score} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
        </div>

        <div style="background: ${interp.color}; color: ${interp.textColor || 'white'}; padding: 20px; border-radius: 8px; font-size: 22px; font-weight: 600; text-align:center;">
          ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô: ${escapeHtml(interp.text)}
        </div>

        <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; text-align: left;">
          <h4 style="color: #667eea; margin-bottom: 10px;">‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ):</h4>
          <ul style="line-height: 1.8; color: #333; margin-left: 18px;">
            <li>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡πâ‡∏¢‡∏≤‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö/‡πÄ‡∏ß‡∏ä‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏á‡∏™‡∏±‡∏¢</li>
            <li>‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏¢‡∏≤/‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏á‡∏™‡∏±‡∏¢ ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ã‡πâ‡∏≥</li>
            <li>‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå/‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á</li>
            <li>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏û‡∏∂‡∏á‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏à‡∏≤‡∏Å‡∏¢‡∏≤ (‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏£‡∏ì‡∏µ‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á) ‡∏ï‡∏≤‡∏°‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á</li>
            ${emergencyFlag ? '<li style="color: #b00020; font-weight: 700;">‚ö†Ô∏è ‡∏û‡∏ö‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì/‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏ß‡∏∞‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô ‡∏Ñ‡∏ß‡∏£‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</li>' : ''}
          </ul>
        </div>
      `;

      // Build report-only HTML (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏¥‡∏°‡∏û‡πå/Save as PDF ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô)
      buildReportOnly({
        hn, firstName, lastName, phone,
        symptomsText, severity, drugsList,
        pharmacistName, pharmacistLicense, assessmentPlace,
        score, interpText: interp.text, interpColor: interp.color, interpTextColor: (interp.textColor || 'white'),
        assessedAt, emergencyFlag
      });

      document.getElementById('result').classList.add('show');
      document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
    });

    function buildReportOnly(data) {
      const footerText = "‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ô‡∏µ‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤ ‡πÇ‡∏î‡∏¢ ‡∏†‡∏Å.‡∏ö‡∏£‡∏£‡∏ì‡∏™‡∏£‡∏ì‡πå ‡πÄ‡∏ï‡∏ä‡∏∞‡∏à‡∏≥‡πÄ‡∏£‡∏¥‡∏ç‡∏™‡∏∏‡∏Ç ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏´‡∏≤‡∏Å‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà bunnasornt@gmail.com";

      // ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô (minimal, print-friendly)
      const html = `
        <div id="reportRoot" style="font-family:'SarabunNew','TH Sarabun New','Sarabun',sans-serif; padding: 24px;">
          <div style="display:flex; justify-content:space-between; align-items:flex-start; gap:12px;">
            <div>
              <h2 style="margin:0; color:#1b2a6b;">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡πâ‡∏¢‡∏≤ (Naranjo)</h2>
              <div style="margin-top:6px; color:#444; font-size:14px;">
                ‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô: ${escapeHtml(data.assessedAt)}
              </div>
            </div>
            <div style="text-align:right; font-size:13px; color:#444;">
              <div><strong>‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô:</strong> ${escapeHtml(data.pharmacistName)}</div>
              <div><strong>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö:</strong> ${escapeHtml(data.pharmacistLicense || '-')}</div>
              <div><strong>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô/‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà:</strong> ${escapeHtml(data.assessmentPlace || '-')}</div>
            </div>
          </div>

          <hr style="border:none; border-top:1px solid #ddd; margin:14px 0 18px;">

          <div style="border:1px solid #e3e6f0; border-radius:10px; padding:14px;">
            <h3 style="margin:0 0 8px; color:#1b2a6b;">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</h3>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:8px 14px; font-size:15px;">
              <div><strong>HN:</strong> ${escapeHtml(data.hn)}</div>
              <div><strong>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£:</strong> ${escapeHtml(data.phone)}</div>
              <div style="grid-column:1 / -1;"><strong>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</strong> ${escapeHtml(data.firstName)} ${escapeHtml(data.lastName)}</div>
              <div style="grid-column:1 / -1;"><strong>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ú‡∏∑‡πà‡∏ô‡πÅ‡∏û‡πâ‡∏¢‡∏≤:</strong> ${escapeHtml(data.symptomsText)}</div>
              <div style="grid-column:1 / -1;"><strong>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á:</strong> ${escapeHtml(data.severity)}</div>
              <div style="grid-column:1 / -1;"><strong>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏á‡∏™‡∏±‡∏¢:</strong> ${escapeHtml(data.drugsList)}</div>
            </div>
          </div>

          <div style="margin-top:16px; display:grid; grid-template-columns:1fr 1fr; gap:12px;">
            <div style="border-radius:10px; padding:14px; background:#1b2a6b; color:#fff;">
              <div style="font-size:14px; opacity:0.95;">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô Naranjo</div>
              <div style="font-size:26px; font-weight:700; margin-top:2px;">${data.score}</div>
            </div>

            <div style="border-radius:10px; padding:14px; background:${escapeHtml(data.interpColor)}; color:${escapeHtml(data.interpTextColor)};">
              <div style="font-size:14px; opacity:0.95;">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</div>
              <div style="font-size:20px; font-weight:800; margin-top:4px;">${escapeHtml(data.interpText)}</div>
            </div>
          </div>

          <div style="margin-top:16px; border:1px solid #e3e6f0; border-radius:10px; padding:14px;">
            <h3 style="margin:0 0 8px; color:#1b2a6b;">‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ)</h3>
            <ol style="margin:0 0 0 18px; line-height:1.7; font-size:15px; color:#222;">
              <li>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡πâ‡∏¢‡∏≤‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö/‡πÄ‡∏ß‡∏ä‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏á‡∏™‡∏±‡∏¢</li>
              <li>‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏¢‡∏≤/‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏á‡∏™‡∏±‡∏¢ ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ã‡πâ‡∏≥</li>
              <li>‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå/‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á</li>
              <li>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏û‡∏∂‡∏á‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏à‡∏≤‡∏Å‡∏¢‡∏≤ (‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏£‡∏ì‡∏µ‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á) ‡∏ï‡∏≤‡∏°‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á</li>
              ${data.emergencyFlag ? '<li style="color:#b00020; font-weight:800;">‡∏û‡∏ö‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì/‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏ß‡∏∞‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô ‡∏Ñ‡∏ß‡∏£‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</li>' : ''}
            </ol>
          </div>

          <div style="margin-top:18px; font-size:12.5px; color:#555; line-height:1.6; border-top:1px solid #eee; padding-top:10px;">
            ${escapeHtml(footerText)}
          </div>
        </div>
      `;

      document.getElementById('reportOnly').innerHTML = html;
    }

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á PDF ‡πÇ‡∏î‡∏¢ ‚Äú‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‚Äù (‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà ‡πÅ‡∏•‡πâ‡∏ß‡∏™‡∏±‡πà‡∏á print)
    function printResultAsPDF() {
      const report = document.getElementById('reportOnly').innerHTML.trim();
      if (!report) {
        alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î ‚Äú‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•‚Äù ‡∏Å‡πà‡∏≠‡∏ô');
        return;
      }

      const w = window.open('', '_blank');
      const doc = `
        <!DOCTYPE html>
        <html lang="th">
        <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <title>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô (Naranjo)</title>
          <link rel="preconnect" href="https://fonts.googleapis.com">
          <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
          <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
          <style>
            @page { size: A4; margin: 14mm; }
            body {
              font-family: 'SarabunNew', 'TH Sarabun New', 'Sarabun', sans-serif;
              color: #111;
              background: #fff;
              margin: 0;
            }
            /* ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏∑‡πà‡∏ô */
          </style>
        </head>
        <body>
          ${report}
          <script>
            window.onload = function() {
              window.focus();
              window.print();
            };
          <\/script>
        </body>
        </html>
      `;
      w.document.open();
      w.document.write(doc);
      w.document.close();
    }

    // Reset ‡∏ó‡∏±‡πâ‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏° + ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå + ‡∏Å‡∏≤‡∏£‡πå‡∏î custom symptoms
    function resetAll() {
      // reset form fields
      const form = document.getElementById('assessmentForm');
      form.reset();

      // reset symptom card selected state + checkbox (‡∏£‡∏ß‡∏° custom)
      document.querySelectorAll('#symptomsGrid .symptom-card').forEach(card => card.classList.remove('selected'));
      document.querySelectorAll('input[name="symptoms"]').forEach(cb => cb.checked = false);

      // ‡∏•‡∏ö custom symptom cards (‡∏Ñ‡∏á‡πÑ‡∏ß‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏° symp1-8)
      const grid = document.getElementById('symptomsGrid');
      const cards = Array.from(grid.querySelectorAll('.symptom-card'));
      cards.forEach(card => {
        const cb = card.querySelector('input[type="checkbox"]');
        if (cb && cb.id && cb.id.startsWith('custom_symp_')) {
          card.remove();
        }
      });

      // reset drugs to 1 entry
      const container = document.getElementById('drugsContainer');
      container.innerHTML = `
        <div class="drug-entry">
          <div class="drug-entry-title">‡∏¢‡∏≤‡∏ó‡∏µ‡πà 1</div>
          <div class="form-group">
            <label>‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤:</label>
            <input type="text" name="drugName[]" required>
          </div>
          <div class="form-group">
            <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏¢‡∏≤:</label>
            <input type="date" name="drugDate[]" required>
          </div>
        </div>
      `;
      drugCount = 1;

      // clear result
      document.getElementById('resultContent').innerHTML = '';
      document.getElementById('reportOnly').innerHTML = '';
      document.getElementById('result').classList.remove('show');

      // scroll to top
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
  </script>
</body>
</html>
